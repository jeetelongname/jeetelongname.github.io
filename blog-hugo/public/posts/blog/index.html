<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="generator" content="Hugo 0.110.0">
		<title> - Jeet&#39;s Blog</title>

		<meta name="description" content="Posts DONE 2am paella&#xa0;&#xa0;&#xa0;cooking&#xa0;cheap&#xa0;easy Introduction Its 2am and your hungry, but you look in the noodle cupboard and you realise your out of instant ramen ðŸ˜±.
Here is a quick way to eat some vegetables, prep some soul filling food and have nummies done in 20ish minutes (which is not bad for something from scratch). This is not a traditional recipe, It kinda is similar but its not authentic in any way, shape or form.">


		
	
		




<link rel="stylesheet" href="/blog/css/ui.css">

	
		

		<script defer src="/blog/js/dark-mode.js"></script>
		<link disabled id="dark-mode-theme" rel="stylesheet" href="/blog/css/dark.css">
		<link  rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono|Lato|Raleway">

		
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/ocean.min.css">
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
		
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/haskell.min.js"></script>
		
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/python.min.js"></script>
		
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/ruby.min.js"></script>
		
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/text.min.js"></script>
		
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/js.min.js"></script>
		
		
	</head>

<body>
<header class="container no-print">
	<div class="u-header">
		<nav class="bar">
	<ul><li>
			<a href="..">
				<img class="icon-text" src="/blog/img/prev.svg"/>
			</a>
		</li><li><img class="icon-text" id="dark-mode-toggle" src="/blog/img/moon.svg" alt="Toggle Dark Mode"></a></li><li><a href="..">Home</a></li><li><a href="/blog/about">About</a></li><li><a href="/blog/posts">Archive</a></li><li><a href="/blog/work">Works</a></li><li><a href="/blog/tags">Tags</a></li></ul>
</nav>

	</div>
</header>
<main class="container">

<article>
	<header><hgroup id="brand">
	<h1></h1>
	<h5>
		
		<time datetime="0001-01-01 00:00:00 &#43;0000 UTC">Jan 01, 0001</time>
		<span class="no-print">
			
			<span>
	</h5>
	
</hgroup>
<hr class="sep" />
</header>
	
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Posts
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<div id="outline-container-headline-2" class="outline-3">
<h3 id="headline-2">
<span class="todo">DONE</span>
2am paella&#xa0;&#xa0;&#xa0;<span class="tags"><span>cooking</span>&#xa0;<span>cheap</span>&#xa0;<span>easy</span></span>
</h3>
<div id="outline-text-headline-2" class="outline-text-3">
<div id="outline-container-headline-3" class="outline-4">
<h4 id="headline-3">
Introduction
</h4>
<div id="outline-text-headline-3" class="outline-text-4">
<p>Its 2am and your hungry, but you look in the noodle cupboard and you realise
your out of instant ramen ðŸ˜±.</p>
<p>Here is a quick way to eat some vegetables, prep some soul
filling food and have nummies done in 20ish minutes (which is not bad for something
from scratch). This is not a traditional recipe, It kinda is similar but its not
authentic in any way, shape or form.</p>
<div id="outline-container-headline-4" class="outline-5">
<h5 id="headline-4">
The things you will use
</h5>
<div id="outline-text-headline-4" class="outline-text-5">
<div id="outline-container-headline-5" class="outline-6">
<h6 id="headline-5">
Ingredience
</h6>
<div id="outline-text-headline-5" class="outline-text-6">
<dl>
<dt>
rice, about a cup
</dt>
<dd>this is the base and pretty non negotiable, pasta may work in a
pinch but it will throw off some ratios and be harder to manage.</dd>
<dt>
vegetables
</dt>
<dd>
<p>this can be anything, except maybe lettuce, here is what I
used.</p>
<ul>
<li>mushrooms of some kind.</li>
<li>an onion, I use spring onions as it also work as a garnish.</li>
<li>bell peppers</li>
<li>and sweet potatoes but again anything will work.</li>
</ul>
</dd>
<dt>
spices
</dt>
<dd>I used turmeric, chilli flakes garlic and garam marsala as that&#39;s what i had
on hand but if you had some harisa powder it would work really well here. But
play with the flavours. Its a blank canvas.</dd>
<dt>
protein
</dt>
<dd>now this is kinda optional as the things mentioned before would
work wonders on its own but if you have chicken pieces or something
similar tossing them in will not hurt. That being said if you do I would try
and keep the skin (if there is any) above the water line to help browning
later.</dd>
</dl>
</div>
</div>
<div id="outline-container-headline-6" class="outline-6">
<h6 id="headline-6">
utensils
</h6>
<div id="outline-text-headline-6" class="outline-text-6">
<ul>
<li>chopping board and knife</li>
<li>serving dish :: i.e plate</li>
<li>oven safe pan :: this is because we will stick it under the broiler but if you
don&#39;t have one then this dish will still be good without broiling the top.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-7" class="outline-5">
<h5 id="headline-7">
the basic method
</h5>
<div id="outline-text-headline-7" class="outline-text-5">
<ol>
<li>preheat the broiler</li>
<li>add some oil to a pan and start to fry your protein.
this is to give it a head start and prevent some nasty smells (boiling
unbrowned meat smells like corpses).</li>
<li>start prepping your veg. you can do this before but this saves on a little
time. Cut them into manageable pieces, they don&#39;t need to be clean or even as
it will all be boiled till tender.</li>
<li>add the veg into the pan and fry it all together.</li>
<li>add in rice to toast as well as the spices before, fry till they are fragrant.</li>
<li>
<p>add water to the pan and boil till rice is soft, keep topping the water up as needed.</p>
<ul>
<li>While its boiling you can basically wash up the chopping board.</li>
</ul>
</li>
<li>once rice is cooked, turn off the heat and put the pan under the hot broiler,
cook until the top is brown (this will happen quick so watch it closely).</li>
<li>eat. Optionally garnish with something green, green bit on spring onions, coriander leaves
go nuts!</li>
</ol>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-8" class="outline-4">
<h4 id="headline-8">
Finishing thoughts
</h4>
<div id="outline-text-headline-8" class="outline-text-4">
<p>This is a fun little dish that acts as a blank canvas. chuck in whatever you
have and let it simmer for a bit and your done!</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-9" class="outline-3">
<h3 id="headline-9">
<span class="todo">TODO</span>
The privacy of public transport
</h3>
<div id="outline-text-headline-9" class="outline-text-3">
<p>We as a world need to pick up public transport. Not only are they usually leagues
better for the environment compared to cars they are also more space efficient
and lead to quieter, safer and nicer cities.</p>
<p>
But this comes at the cost of a few things (some of which can be fixed with
funding and time) but one of them seems almost un refutable. The idea of privacy
on transport. Now while in a theoretical sense this is true you are essentially
in a crowed of people any of which could approach you, in practice its one of
the more private experiences I have had.</p>
<div id="outline-container-headline-10" class="outline-4">
<h4 id="headline-10">
The Car
</h4>
<div id="outline-text-headline-10" class="outline-text-4">
<p>The car is meant to be the epitome of freedom and privacy, go wherever you want
with no need to interact with people. But in this case there is the lack of
something. Either you are the driver in which case you are not free to do things
like work, read or sleep and in a sense the time is wasted driving. Or you are
a passenger in which case you are also not free (unless you are being driven
around which is out of the reach of 90% of the population). You are attached to
the social graces that come with human interaction in a confined space or are in
an even more mundane situation where you are the navigator or other auxiliary
function within the journey.</p>
<p>
In either sense your not free to use that time in
some kind of productive manner and this will only get worse with more people in
this confined space, I say this as someone who has had one to many packed road
trips and dead butt cheeks.</p>
</div>
</div>
<div id="outline-container-headline-11" class="outline-4">
<h4 id="headline-11">
Public Transport
</h4>
<div id="outline-text-headline-11" class="outline-text-4">
<p>With public transport I don&#39;t have this to worry about. When I am travelling
alone (which is most of the time). I am free to do what I want. I usually read
but am free to do some light work, free to rest to some degree as well. In reality I do
not have to talk to people other than the bus driver or odd ticket collector.
Other people are not a problem as they don&#39;t want to talk to me as much as I
don&#39;t want to talk to them. This is much more private and much more free,
especially with the ability to buy tickets on my phone the amount of interaction
with other human life goes down to near zero. And the interaction that does
happen is quick or pleasant enough that I enjoy it.</p>
<p>
This being said this is not a blanket privacy, you can&#39;t break down on a train
the same way you can in a car, nor could you use a train as a home when camping
or when times are tough. Its not a private compartment but it is a nice social
interaction bubble which in a lot of contexts is all people need.</p>
</div>
</div>
<div id="outline-container-headline-12" class="outline-4">
<h4 id="headline-12">
Conclusion
</h4>
<div id="outline-text-headline-12" class="outline-text-4">
<p>Public Transport is similar to a cafe. When you sit down at a table even though
you are in a crowd you are alone, and unless you are being loud or (for lack of
a better term) <em>weird</em> then you are left alone for the most part. This privacy
in public in a way is freeing and something that becomes a nice to use after a
while.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-13" class="outline-3">
<h3 id="headline-13">
<span class="todo">TODO</span>
Pacific Rim, Mecha and Charm&#xa0;&#xa0;&#xa0;<span class="tags"><span>movies</span>&#xa0;<span>opinion</span></span>
</h3>
<div id="outline-text-headline-13" class="outline-text-3">
<p>Pacific Rim is one of my favorite movies, not because it says something deep
about society, or the human soul, not because its even that well made. But
because its a direct, witty, campy movie that opens up my inner 9 year old in
more ways than one. Its a deeply fun and interesting movie that almost forces
you back to being that child that loves the carnal pleasure of citys being
destroyed by biggest baddest robot fighting the biggest baddest robots.</p>
<div id="outline-container-headline-14" class="outline-4">
<h4 id="headline-14">
The babble
</h4>
<div id="outline-text-headline-14" class="outline-text-4">
<p>and boy does this movie have a lot. Its a massive word soup that is thrown at
you hot and fast.</p>
<blockquote>
<p>Solid iron hull, no alloys.
Forty engine blocks per muscle strand.
Hyper-torque driver for every limb
and a new fluid synapse system.</p>
</blockquote>
<p>This almost forces you to just let your mind run wild, there is nothing to
compare it against so we are forced to run with the discriptors, we start going
to bigger numbers cooler words and in essence, we dumb down our thought. This
does not stop mind you. We are bombarded with it throughout the movie. It is
never meant to be focused on, this is not a technical movie that wants to build
a technical world. but its use makes us</p>
</div>
</div>
<div id="outline-container-headline-15" class="outline-4">
<h4 id="headline-15">
The Mechs
</h4>
<div id="outline-text-headline-15" class="outline-text-4">
<p>Or Jaegers as they are known. meaning Hunter in German they are less</p>
</div>
</div>
<div id="outline-container-headline-16" class="outline-4">
<h4 id="headline-16">
The Characters
</h4>
</div>
<div id="outline-container-headline-17" class="outline-4">
<h4 id="headline-17">
The Charm
</h4>
</div>
</div>
</div>
<div id="outline-container-headline-18" class="outline-3">
<h3 id="headline-18">
<span class="todo">DONE</span>
Dr Strange: Movie of madness&#xa0;&#xa0;&#xa0;<span class="tags"><span>movies</span>&#xa0;<span>opinion</span>&#xa0;<span>spoilers</span></span>
</h3>
<div id="outline-text-headline-18" class="outline-text-3">
<p>I recently, like a lot of people, watched the new Dr Strange movie. I found
itâ€¦ underwhelming to say the least. Even though it looked great I left that
movie hall feeling like I just watched an underused mess. It was almost not as
fun as having to deal with the ire of my family, as I was the one who chose the
movieâ€¦</p>
<p>
BTW this is an adaptation from a long discord message I posted in the <a href="https://doomemacs.org/discord">doom emacs
discord server</a> soâ€¦ Hi Lejon! I guess.</p>
<div id="outline-container-headline-19" class="outline-6">
<h6 id="headline-19">
<strong>Spoilers ahead, you have been warned</strong>
</h6>
</div>
<div id="outline-container-headline-20" class="outline-4">
<h4 id="headline-20">
The movie
</h4>
<div id="outline-text-headline-20" class="outline-text-4">
<p>In a word it felt like an underused cobbled together mess.
I watched it in 2D, this meant that I did not get the face punching 3d affects
and most of the spectacle of the story was squarely on the story (though the
movie still looked great). I think with better writing not only would the themes
and concepts have felt more solid but we would have more use (and proper use) of
characters.</p>
<p>
The villain introduction relied on you watching Wanda Vision for the arc to make
sense, otherwise if you are a casual, coming straight from endgame it felt very
much out of left field.</p>
<p>
Characters that were teased at in the first Dr Strange, principally Mordo, a
character who was teased as the villain for the sequel was not even shown. We
instead get a Mordo that is not the one that has been built up and is then
thrown away after a mild fist fight with little resolution to what he means to
Strange. This lack of continuity from its principal prequel felt like a pressure
release valve going off. All bets are off and all tension is cut. This will not
translate over to any third movie as it would have been too long. the first
movie was released in 2016â€¦ 6 years ago. another movie will not be coming for a
while and by that time at least my psyche would have moved on. Mordo and his
build up would have been wasted.</p>
<p>
The Illuminati (why the illuminati??) present in universe 838 were comprised of the
first cannon introductions of both the Fantastic Four and the Xmen in the MCU
(M?) both of which were over very quickly on screen, it felt like &#34;oh this is a
thing that will be coming in the later movies but we want to tease it now&#34;. Then
you also have Peggy Carter as Captain Britain (or whatever), principally a call
back to What If but if you did not watch that, it was a gag. A lesser example of
the problem I had with Wanda&#39;s arc.</p>
</div>
</div>
<div id="outline-container-headline-21" class="outline-4">
<h4 id="headline-21">
Themes from a box
</h4>
<div id="outline-text-headline-21" class="outline-text-4">
<p>
Themes are presented such as happiness, motherhood, loss and confidence.
None of these felt explored in any satisfactory way.
Happiness was not really dealt with, Strange was just kinda asked &#34;are you
happy?&#34; and lied through his teeth, this then came up near the end as well when
evil Strange number 3 asked the same question and then they started fighting
with music notes. It was kinda resolved with the monologue to 838 Christine but
in a cheesy way, not in anything that felt good for the character. It felt like
the cliche line and a cliche theme that did not do much for our character. I
feel like the movie would not have been different if it was not included.</p>
<p>
Motherhood was better in this regard. It gave Wanda&#39;s sacrifice weight in a
sense and was played in little bits though out the movie, as she dreamed and dream
walked. It added to her ending seeing her actions come to a head and see how she
will never be a mother to any child she abducts. It was a good scene and a good
theme.</p>
<p>
Confidence on the other hand while being intertwined with happiness also takes a
lot of traits from it (not really but the parallels are there). it did not feel
dealt with in any real sense though out the movie and it just came to the head
that was the power of friendship ending where the protagonist learns to believe
in themselves and then girlbosses scarlet witch. It felt rushed with no real
build up.</p>
</div>
</div>
<div id="outline-container-headline-22" class="outline-4">
<h4 id="headline-22">
Multiverse ofâ€¦ not much?
</h4>
<div id="outline-text-headline-22" class="outline-text-4">
<p>
The concept of multiverse was very much underused with us not getting a chance
to really see it. This does not mean I want to see a massive amount of
universes but want to see <em>the concept</em>. Otherwise it does not become a
distinct thing, a concept the movie plays with, but a plot device that does
nothing but give our characters reason to move (editor&#39;s note: a MacGuffin
(Thanks Lejon)), as well as fuel this power of
love story ending (I know its not actually a power of love ending, I am taking a
little bit of piss)
Some may say It was never explained in any real way which reflects
the unknown nature of it to our protagonists, but even still with this it does
not feel distinct in any meaningful way</p>
</div>
</div>
<div id="outline-container-headline-23" class="outline-4">
<h4 id="headline-23">
What this says about the MCU
</h4>
<div id="outline-text-headline-23" class="outline-text-4">
<p>
This speaks to a bigger problem I saw in endgame but think this movie
exemplifies, The MCU has gotten too big to be cohesive. Most of the movie felt
like callbacks, teasers and set up with actual substance being lost. It leads to
a movie that felt hollow in many senses, gravity has been lost and points of
interest have become little more than lore points for the overall arc in
phase 5. As it grows if you want to stay in the loop and understand most movies
fully, you need to watch everything that comes before, its getting to the point
where there are entire sub markets writing up plot summaries so that you can
understand the movie. This essentially excludes the casual from the franchises
they enjoy, People may only tune in for the movies they care about (for me those
being the spiderman and Dr Strange and maybe Thor) they are left out. Now I
could go on about how this is all to drive up profit and coerce people into
going to every movie and watching all the shows on Disney+ but that&#39;s for another
day.</p>
<p>
Part of the magic of the first set of movies was that it was a small rag tag
team that had there own introductions, each movie added context but also did not
become required reading to understand in full.</p>
<p>
Endgame was the beginning of this. This movie is the beginning of the end.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-24" class="outline-3">
<h3 id="headline-24">
<span class="todo">DONE</span>
Moving to Wayland! Login shell lambasting&#xa0;&#xa0;&#xa0;<span class="tags"><span>gnome</span>&#xa0;<span>wayland</span>&#xa0;<span>fix</span>&#xa0;<span>hack</span></span>
</h3>
<div id="outline-text-headline-24" class="outline-text-3">
<div id="outline-container-headline-25" class="outline-4">
<h4 id="headline-25">
The problem
</h4>
<div id="outline-text-headline-25" class="outline-text-4">
<p>I have been trying to move to Wayland for the past year. The call of gestures,
less artifacting and just the <em>hype</em> had me spell bound. The problem was,
GNOME, my DE of choice, decided to make what I think is the asinine choice to not
start the DE in a login shell. All this meant was my <code>.profile</code> never runs and my nix
environment never get set up. This is a deal breaker for me because I have
programs I use every day (principally emacs) which I can now not access.</p>
<p>
This is not a problem though! GNOME has thought of everything! you can now
<em>declarativly</em> declare all the environment variables you want with an
<code>environment.d/*.conf</code> file!.. Oh wait. I can&#39;t run shell scripts with thatâ€¦
That&#39;s
the reason I could not use my nix programs, nix sets its environment using a set of external shell
scripts that can and do change as nix installs and removes packages. This is not
a problem for a login shell as it just runs them like any normal sourced file.
But you can&#39;t run scripts in this conf file meaning nix stays unusable.</p>
</div>
</div>
<div id="outline-container-headline-26" class="outline-4">
<h4 id="headline-26">
What was my solution then?
</h4>
<div id="outline-text-headline-26" class="outline-text-4">
<p>Well my first port of call was of course to force GNOME to start a Wayland
session in a login shell. After all thats how other people get other Wayland
environments to respect there <code>.profiles</code>. Ez slap a <code>-l</code> in the exec call of
whatever program starts GNOME and we are golden rightâ€¦ Well no. While you can
wiggle GNOME into running a login shell, it seems its allergic to running in a
Wayland session. I am not sure of the black magic GNOME does to start its
Wayland session but its above my pay grade.
That being said I have tried most things from fiddling with the xsession file to
pass in a <code>-l</code> argument, to making my own slightly modified <code>gnome-session</code>
start up script. They either did not spawn a Wayland session, or did not load my
<code>.profile</code> (or in one entertaining case did not launch GNOME at all, I just had
a bare x display server). In any sense it did not work and it made me sad.</p>
<div id="outline-container-headline-27" class="outline-5">
<h5 id="headline-27">
The actual solution
</h5>
<div id="outline-text-headline-27" class="outline-text-5">
<p>But thanks to Flat on the doom emacs discord server, for breaking me out of the
rut I was in, and inspiration from the <a href="https://github.com/doomemacs/doomemacs">doom env command</a>
Instead of trying to force GNOME into the login shell, bring my login shell
(more specifically my environment) to GNOME!</p>
<p>
This is where I ask you to flash back to 20 seconds ago
where I mentioned the <code>environment.d/*.conf</code> files. Well all we are doing is setting
environment variables with our <code>.profile</code>, if we could capture all of the
environment variables my <code>.profile</code> sets and pipe that into a conf file We would
be done! In a nice list it would take three things:</p>
<ul>
<li>an empty environment to actually see <em>exactly</em> what is being set</li>
<li>A command to run my .profile</li>
<li>a command to print all the set environment variables</li>
</ul>
<p>The first and last are actually handled by the <code>env</code> command!  Just call it with
the <code>-i</code> flag and it starts with and empty environment! Then call it at the end
to get my list! Now to read my .profile.
Turns out we can just call <code>sh</code> with the <code>-l</code> flag to start a login shell, like I
have been wanting to do with GNOME! This leads to this very nice one liner which
I can then redirect into a <code>.conf</code> file like so.</p>
<div class="src src-shell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>env -i HOME=/home/jeet sh -l -c env &gt; ~/.config/environment.d/profile.conf</span></span></code></pre></div>
</div>
<p>
I don&#39;t even have to do any parsing as it&#39;s already in the syntax the
<code>environment.d</code> expects!
And that was it! Just that one liner and a log out and I can finally use Wayland!
Its such a simple hack in retrospect. All I would need to do now is hook this
into running at the tail end of a nix update to recapture my environment and
this hack would be seemless!</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-28" class="outline-4">
<h4 id="headline-28">
Conclusion
</h4>
<div id="outline-text-headline-28" class="outline-text-4">
<p>The fact I have had to do this in the first place feels silly. I love GNOME and
I can understand why the devs would want to move to a more intergrated system in
a sense. Does not stop me from being mad I had to wait a year to be able to use
Wayland full time. Or that I have had to spend so much time trying to figure out
how to wiggle <em>my not unpopular use case</em> into something usable. In any case the fix is
there, even if its not preferred, and I can move onto bigger things! This may be
the beginning of a set of posts about Wayland and my adaptations to it so stay tuned!</p>
<p>
And if you did manage to actually get a GNOME Wayland session to start in a login
shell though please do reach out!</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-29" class="outline-3">
<h3 id="headline-29">
<span class="todo">TODO</span>
Doom, Emacs and Communication
</h3>
<div id="outline-text-headline-29" class="outline-text-3">
<p>Recently Protesilaos, also known as Prot, wrote a blog post detailing <a href="https://protesilaos.com/codelog/2022-08-04-doom-git-gutter-modus-themes/">how Dooms
configuration of Git Gutter constituted a soft fork</a> in so far it broke his modus
themes. I will not detail what happened here as Prot does a fine job of that
(<a href="https://github.com/doomemacs/doomemacs/commit/cd9bc5a1fdaacc41b7e0f05012509ba2814cef89">and as it was addressed upstream</a>).
The problem with what happened here is that nowhere in this process the doom
project was informed of this problem. In this case instead of notifying the doom
project It was diagnosed and documented in the manual. The doom project finally
came to know when said blog post was posted and steps were taken within a timely
manner. With more steps being worked on to address the problems stated.</p>
<p>
This then happens again in the release of <a href="https://protesilaos.com/codelog/2022-08-19-modus-themes-2-6-0/">modus themes 2.6.0</a> Where the theme
drops support for <a href="https://github.com/hlissner/emacs-solaire-mode">solaire mode</a> on the grounds that doom users opt into using the
package without knowing, thus leading to the themes being sub par out of the box
(again I recommend reading the release log linked above). This is not to suggest
that themes need to support solaire mode (<a href="https://github.com/hlissner/emacs-solaire-mode/commit/56f6d9ea9cfa3f3fd5d64d995381fdb0da898b28">and solaire works in such a way to
deactivate when a theme does not support it</a>) but again neither the doom
project or the maintainer of solaire (in this case the same person) got
notified and again found out through this code log.</p>
<p>
In a word this is not a good way to act. The doom project cannot stay on top of
how every package in the emacs ecosystem will interact with doom and to ask of
that is silly.</p>
<p>
I can empathise with package maintainers, getting issues they
can&#39;t diagnose because the problem is not with there package but with how that
package interacts with doom. But the solution here is not to silently move on
(only for it to resurface later on) but to talk to the project. If a problem is
coming up then make an issue on the bug tracker, discourse or shoot a message to
us in the discord . From there we can work to a solution that both parties
can accept, In the former example it was a simple matter of gating the
config. The latter could have either been solved on the solaire side or on the
doom side (in this case its the same maintainer). The solutions are to be had
if only the community talked with us about these issues.</p>
<div id="outline-container-headline-30" class="outline-4">
<h4 id="headline-30">
Dooms relationship to the wider community
</h4>
<div id="outline-text-headline-30" class="outline-text-4">
<p>It makes sense to discuss how doom relates to the rest of the community as it&#39;s
special in this regard.
In a phrase doom is a middle man, taking packages and
configuring them for end users. This means for us that we need to have
relationships with both sides of this equation, and to some degree we do. We
have package maintainers who discuss problems with us as we develop modules
using there packages. We also have doom users who also maintain packages that
then get put back into doom!.</p>
</div>
</div>
<div id="outline-container-headline-31" class="outline-4">
<h4 id="headline-31">
Who the forums are for
</h4>
<div id="outline-text-headline-31" class="outline-text-4">
<p>In a word, Everyone. This is an area of active improvement for us as we
introduce new constructs to make sure that maintainers can voice there <em>things</em>
with us in a constructive manner. But this should not stop maintainers talking
to us, if your package is interacting badly with doom, raise it on the discourse
or github. If you want to discuss something indepth, join us on the discord
(eventually there will also be a matrix room if thats more your style). The key
here being the forums are for everyone and not just users.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-32" class="outline-3">
<h3 id="headline-32">
<span class="todo">DONE</span>
I finally understand monads and now I will write about it&#xa0;&#xa0;&#xa0;<span class="tags"><span>haskell</span>&#xa0;<span>programming</span></span>
</h3>
<div id="outline-text-headline-32" class="outline-text-3">
<p>CLOSED: [2022-11-23 Wed 05:53]</p>
<p>After a lot of struggle I finally understand monads and why they are useful.
This is less an explainer and more of a write up of my understanding. In any
case let us get started.</p>
<div id="outline-container-headline-33" class="outline-4">
<h4 id="headline-33">
So what is a monad?
</h4>
<div id="outline-text-headline-33" class="outline-text-4">
<p>A monad is a datatype that can use <code class="verbatim">&gt;&gt;=</code>, You can call it <code>bind</code> or <code>then</code> with
the latter name leading into what it does.
Here is its type.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(&gt;&gt;=) <span style="color:#00f">::</span> m a <span style="color:#00f">-&gt;</span> (a <span style="color:#00f">-&gt;</span> m b) <span style="color:#00f">-&gt;</span> m b</span></span></code></pre></div>
</div>
<p>This function takes in a context of <code class="verbatim">m a</code>, then a function which transforms that
inner value, returning that transformed value in the same context.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>print $ <span style="color:#2b91af">Just</span> 1 &gt;&gt;= return . (+1)
</span></span><span style="display:flex;"><span>print $ <span style="color:#2b91af">Just</span> 2 &gt;&gt;= return . (+1)</span></span></code></pre></div>
</div>
<pre class="example">
Just 2
Just 3
</pre>
<p>
This allows for many operations to be chained together, as the return value of
the first becomes the input of the next.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>print $ <span style="color:#2b91af">Just</span> 1 &gt;&gt;= return . (+1) &gt;&gt;= return . (+1)</span></span></code></pre></div>
</div>
<pre class="example">
Just 3
</pre>
<div id="outline-container-headline-34" class="outline-5">
<h5 id="headline-34">
Do notation
</h5>
<div id="outline-text-headline-34" class="outline-text-5">
<p>This chaining of operations looks a lot like imperative programming. This is in
part why <code>do</code> notation exists. If we were to use IO (which is a value
contained in the context that it came from an input output system.)
This</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>print <span style="color:#a31515">&#34;Hello, what is your name?&#34;</span> &gt;&gt;= \<span style="color:#00f">_</span> <span style="color:#00f">-&gt;</span> getLine &gt;&gt;= \name <span style="color:#00f">-&gt;</span> print $ <span style="color:#a31515">&#34;Hello &#34;</span> ++ name</span></span></code></pre></div>
</div>
<p>Turns into</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>main <span style="color:#00f">=</span> <span style="color:#00f">do</span>
</span></span><span style="display:flex;"><span>  print <span style="color:#a31515">&#34;Hello, what is your name?&#34;</span>
</span></span><span style="display:flex;"><span>  name <span style="color:#00f">&lt;-</span> getLine
</span></span><span style="display:flex;"><span>  print (<span style="color:#a31515">&#34;Hello &#34;</span> ++ name)</span></span></code></pre></div>
</div>
<p>Which should look pretty familiar to you.
Here is what the python looks like</p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#00f">def</span> main():
</span></span><span style="display:flex;"><span>    print(<span style="color:#a31515">&#34;Hello, what is your name?&#34;</span>)
</span></span><span style="display:flex;"><span>    name = input()
</span></span><span style="display:flex;"><span>    print(<span style="color:#a31515">&#34;Hello &#34;</span> + name)</span></span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-35" class="outline-4">
<h4 id="headline-35">
Okay this is cool and all, but why do we need to implement functor and applicative??
</h4>
<div id="outline-text-headline-35" class="outline-text-4">
<p>Well when you look at what we are doing, <code class="verbatim">&gt;&gt;=</code> hides a lot from us.
When we have a look at what functor and applicative add to the
equation we can hopefully see why we need them as well.</p>
</div>
</div>
<div id="outline-container-headline-36" class="outline-4">
<h4 id="headline-36">
Functors
</h4>
<div id="outline-text-headline-36" class="outline-text-4">
<p>A functor is a datatype where we can (f)map the inner value without losing the
outer context.
It gives us the <code class="verbatim">&lt;$&gt;</code> operator, otherwise know as fmap.
Its type is</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(&lt;$&gt;) <span style="color:#00f">::</span> (a <span style="color:#00f">-&gt;</span> b) <span style="color:#00f">-&gt;</span> f a <span style="color:#00f">-&gt;</span> f b</span></span></code></pre></div>
</div>
<p>
This operation takes a function that transforms <code class="verbatim">type a</code> into <code class="verbatim">type b</code>, and then
a functor of <code class="verbatim">type a</code>, it transforms it into a functor of =type=b.
Simple enough.</p>
<p>
One little side note, <em>haskell is curried</em> meaning that we can write
something like this <code class="verbatim">(f &lt;$&gt;)</code> Which returns a function that takes a functor of
<code class="verbatim">type a</code>.
If we say for demonstration that <code class="verbatim">f</code> is a function that takes an <code class="verbatim">Int</code> and
returns a <code class="verbatim">String</code>, our types would look like this.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>f <span style="color:#00f">::</span> <span style="color:#2b91af">Int</span> <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">String</span>
</span></span><span style="display:flex;"><span>(f &lt;$&gt;) <span style="color:#00f">::</span> f <span style="color:#2b91af">Int</span> <span style="color:#00f">-&gt;</span> f <span style="color:#2b91af">String</span></span></span></code></pre></div>
</div>
<p>Essentially we have transformed our lowly <code class="verbatim">f</code> that can only work on simple types
into a function that works on functors. This is known as a <em>lift</em> operation.
This is important for later.</p>
</div>
</div>
<div id="outline-container-headline-37" class="outline-4">
<h4 id="headline-37">
Applicatives
</h4>
<div id="outline-text-headline-37" class="outline-text-4">
<p>Applictives add a few more operations to the mix, notably <code class="verbatim">pure</code> and <code class="verbatim">&lt;*&gt;</code>
Here are the types</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>pure <span style="color:#00f">::</span> a <span style="color:#00f">-&gt;</span> f a
</span></span><span style="display:flex;"><span>(&lt;*&gt;) <span style="color:#00f">::</span> f (a <span style="color:#00f">-&gt;</span> b) <span style="color:#00f">-&gt;</span> f a <span style="color:#00f">-&gt;</span> f b</span></span></code></pre></div>
</div>
<p>Pure is simple enough. It takes a value and &#34;wraps&#34; it into an applicative. This
raises a value and allows us to use it in the applicative space.
<code class="verbatim">&lt;*&gt;</code> takes a function wrapped in an applicative and compose it with another
applicative. If you compare its type to that of <code class="verbatim">&lt;$&gt;</code> we can see that they are
similar but <code class="verbatim">&lt;*&gt;</code> allows us to use a function in a context! this makes it a more
general version of functor.</p>
<p>
Also note that</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(f &lt;$&gt;) <span style="color:#00f">::</span>  f <span style="color:#2b91af">Int</span> <span style="color:#00f">-&gt;</span> f <span style="color:#2b91af">String</span>
</span></span><span style="display:flex;"><span>(pure f &lt;*&gt;) <span style="color:#00f">::</span> f <span style="color:#2b91af">Int</span> <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">String</span></span></span></code></pre></div>
</div>
<div id="outline-container-headline-38" class="outline-5">
<h5 id="headline-38">
Why is this useful
</h5>
<div id="outline-text-headline-38" class="outline-text-5">
<p>Well these operations allow us to compose contexts together, something that was
not possible with just <code class="verbatim">&lt;$&gt;</code>
For example lets take <code class="verbatim">(min &lt;$&gt;)</code> as an example</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>min <span style="color:#00f">::</span> a <span style="color:#00f">-&gt;</span> a <span style="color:#00f">-&gt;</span> a
</span></span><span style="display:flex;"><span>(min &lt;$&gt;) <span style="color:#00f">::</span> f a <span style="color:#00f">-&gt;</span> f (a <span style="color:#00f">-&gt;</span> a)</span></span></code></pre></div>
</div>
<p>Here we are using a function that takes two arguments rather than one and here
we can see our problem. We have a function wrapped in a context. <em>If only there</em>
<em>was an operation that allowed us to compose contexts together</em>.
As we can see the left hand side of this equation has the type of <code class="verbatim">f (a -&gt; a)</code>,
the right has the type of <code class="verbatim">f a</code> these, which then combine and come to the correct
result.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>min &lt;$&gt; <span style="color:#2b91af">Just</span> 1 &lt;*&gt; <span style="color:#2b91af">Just</span> 2</span></span></code></pre></div>
</div>
<p>
This scales. Here is a function which takes in three arguments and adds them.
Here we lift f then apply one context. We get back a value which takes in
another context and returns a function within that same context <sup class="footnote-reference"><a id="footnote-reference-1" href="#footnote-1">1</a></sup> which we can continue to
chain with other values using <code class="verbatim">&lt;*&gt;</code></p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>f <span style="color:#00f">::</span> a <span style="color:#00f">-&gt;</span> a <span style="color:#00f">-&gt;</span> a <span style="color:#00f">-&gt;</span> a
</span></span><span style="display:flex;"><span>f a b c <span style="color:#00f">=</span> a + b + c
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(f &lt;$&gt;) <span style="color:#00f">::</span> f a <span style="color:#00f">-&gt;</span> f (a <span style="color:#00f">-&gt;</span> a <span style="color:#00f">-&gt;</span> a)
</span></span><span style="display:flex;"><span>(f &lt;$&gt; <span style="color:#2b91af">Just</span> 1 &lt;*&gt;) <span style="color:#00f">::</span> f a <span style="color:#00f">-&gt;</span> f (a <span style="color:#00f">-&gt;</span> a)
</span></span><span style="display:flex;"><span>(f &lt;$&gt; <span style="color:#2b91af">Just</span> 1 &lt;*&gt; <span style="color:#2b91af">Just</span> 1 &lt;*&gt;) <span style="color:#00f">::</span> f a <span style="color:#00f">-&gt;</span> f a</span></span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-39" class="outline-4">
<h4 id="headline-39">
<del>Bringing</del> <em>Binding</em> this all together
</h4>
<div id="outline-text-headline-39" class="outline-text-4">
<p>So we have the ability to transform the inner value of a context, we have the
ability to compose two or more contexts together. The problem arises when we want to
compute the next context based on the result of the previous. Look again at the
type of <code class="verbatim">&lt;*&gt;</code></p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(&lt;*&gt;) <span style="color:#00f">::</span> f (a <span style="color:#00f">-&gt;</span> b) <span style="color:#00f">-&gt;</span> f a <span style="color:#00f">-&gt;</span> f b</span></span></code></pre></div>
</div>
<p>we know the end goal of this computation as all <code class="verbatim">&lt;*&gt;</code> is doing is satsfying the contexed
function. This limits us to computations where we can reason about the end
result. What about a computation where we can&#39;t, where we need to think about the
last computation before we move on. This is a power monads have.</p>
<p>
Lets revist the type of <code class="verbatim">&gt;&gt;=</code></p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(&gt;&gt;=) <span style="color:#00f">::</span> m a <span style="color:#00f">-&gt;</span> (a <span style="color:#00f">-&gt;</span> m b) <span style="color:#00f">-&gt;</span> m b</span></span></code></pre></div>
</div>
<p>The first argument is a contexted value, You can reason about it like its some
kind of computation. This computation is then &#34;unwrapped&#34; and passed into a
function which crucially <em>can decide what to do</em>. We do not need to think about
whatever end goal we want right at the beginning, we can go as the wind tells us,
so to speak. This is useful in places we need to parse some kind of contextual
information, for
example a context filled language such as some markup languages, <a href="https://orgmode.org/">including the
one I am currently writing this post in</a>.</p>
</div>
</div>
<div id="outline-container-headline-40" class="outline-4">
<h4 id="headline-40">
A monad in plain sight
</h4>
<div id="outline-text-headline-40" class="outline-text-4">
<p>So we have discussed what all of these things are but lets discuss a real world
monad, One that you probably have already used. The Async Monad!</p>
<p>
Yes if you have done Async programming then you have used a monad. Lets
have a look at an example.</p>
<div class="src src-js">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>fetch(<span style="color:#a31515">`http://localhost:8080/some-data`</span>).then(response =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#00f">if</span> (response.ok) {
</span></span><span style="display:flex;"><span>        response.text().then(text =&gt; JSON.parse(text))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>})</span></span></code></pre></div>
</div>
<p>Here we receive a promised response from fetch. We then unwrap its inner value and
get our response object. After playing with it, we extract out the text (which
is a Promised string) and parse it into a json object. This entire expression
returns a Promised JSON object.</p>
<p>
In this case we take a context, unwrap it, then return back the same context
with a transformed value.</p>
<p>
We decide as we go, Our next computation is dependent on the value of the last.</p>
<p>
Note how <code class="verbatim">async await</code> is basically do notation in this case</p>
<div class="src src-js">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#00f">const</span> getData = <span style="color:#00f">async</span> (idx) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#00f">let</span> response = <span style="color:#00f">await</span> fetch(<span style="color:#a31515">&#39;http://localhost:8080/some-data&#39;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#00f">if</span> (response.ok) {
</span></span><span style="display:flex;"><span>        <span style="color:#00f">let</span> text = <span style="color:#00f">await</span> response.text();
</span></span><span style="display:flex;"><span>        <span style="color:#00f">return</span> JSON.parse(text);
</span></span><span style="display:flex;"><span>    } <span style="color:#00f">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#00f">throw</span> <span style="color:#00f">new</span> Error(<span style="color:#a31515">&#34;An error has occured&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};</span></span></code></pre></div>
</div>
<p>
<code class="verbatim">async</code> = <code class="verbatim">do</code></p>
<p>
<code class="verbatim">await</code> = <code class="verbatim">&lt;-</code></p>
</div>
</div>
<div id="outline-container-headline-41" class="outline-4">
<h4 id="headline-41">
Why did I write this?
</h4>
<div id="outline-text-headline-41" class="outline-text-4">
<p>This is an explainer I have done, less because I want to try and be the one to
tackle the monad fallacy but because its fun and a good way to help me solidify
what I know. Plus it may start to
help build intuitions on these types. Though it must be said</p>
<blockquote>
<p>There is no royal road to Haskell. â€”Euclid</p>
</blockquote>
<p>
The best way to learn is to get your hands on them and play with them. No amount
of theory will do you any good unless you put these ideas into practice. Once
you do you start to see the patterns and then you can really get into the meat
of them and become an epik haskeller.
Some of the resources I really like include <a href="https://wiki.haskell.org/Typeclassopedia">The Typeclassopedia</a>, <a href="https://www.youtube.com/watch?v=fCoQb-zqYDI">This video on
the IO monad,</a> this <a href="https://www.youtube.com/watch?v=N9RUqGYuGfw">video implementing a json parser in haskell</a> and <a href="https://www.cis.upenn.edu/~cis1940/spring13/lectures.html">this course
from the University of Pennsylvania</a>.
Though it did not really begin to click until I started playing with Async in
Dart.</p>
<p>
Hopefully this is helpful and or interesting. If I have made a mistake or you
want to discuss this <a href="mailto:jeetelongname@gmail.com">my email is here!</a></p>
</div>
</div>
<div id="outline-container-headline-42" class="outline-4">
<h4 id="headline-42">
Footnotes
</h4>
</div>
</div>
</div>
<div id="outline-container-headline-43" class="outline-3">
<h3 id="headline-43">
<span class="todo">TODO</span>
Web scripting with ruby&#xa0;&#xa0;&#xa0;<span class="tags"><span>opinion</span>&#xa0;<span>programming</span>&#xa0;<span>ruby</span></span>
</h3>
</div>
<div id="outline-container-headline-44" class="outline-3">
<h3 id="headline-44">
<span class="todo">TODO</span>
Recreating the JS object system in ruby&#xa0;&#xa0;&#xa0;<span class="tags"><span>ruby</span>&#xa0;<span>javascript</span>&#xa0;<span>oop</span>&#xa0;<span>hack</span>&#xa0;<span>programming</span></span>
</h3>
<div id="outline-text-headline-44" class="outline-text-3">
<p>I had a funky idea, why not try and re create the js object system in ruby?
Why? well because we can.
This idea dawned on me when I realised I can add the functionality of property
like accesses to hash values using method missing.</p>
<div class="src src-ruby">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#00f">class</span> <span style="color:#2b91af">Hash</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">def</span> method_missing(prop, *args, &amp;block)
</span></span><span style="display:flex;"><span>    self[prop]
</span></span><span style="display:flex;"><span>  <span style="color:#00f">end</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hash = {
</span></span><span style="display:flex;"><span>  <span style="color:#a31515">hello</span>: <span style="color:#a31515">&#34;hello is not a method ðŸ˜±&#34;</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts hash.hello <span style="color:#008000">#=&gt;  &#34;hello is not a method ðŸ˜±&#34;</span></span></span></code></pre></div>
</div>
<p>Ignoring the method definition this looks a lot like javascript. and now I want to
see how far we can take it.</p>
<div id="outline-container-headline-45" class="outline-4">
<h4 id="headline-45">
Some expectations
</h4>
<div id="outline-text-headline-45" class="outline-text-4">
<p>Now this will not lead to a full look alike of Javascripts object system. we can
get close but we are still limited by rubys syntax. In any case I think we can
create something that works a lot like the function and learn something along
the way!</p>
</div>
</div>
<div id="outline-container-headline-46" class="outline-4">
<h4 id="headline-46">
Why javascripts object system is special
</h4>
<div id="outline-text-headline-46" class="outline-text-4">
<p>Lets take a minute to discuss javascripts object system.
JS is interesting because you do not need to go through classes to make objects.</p>
</div>
</div>
<div id="outline-container-headline-47" class="outline-4">
<h4 id="headline-47">
Properties
</h4>
<div id="outline-text-headline-47" class="outline-text-4">
<p>Properties are our object attributes, they are our values, they can be read and
written too</p>
<div class="src src-javascript">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>obj = {
</span></span><span style="display:flex;"><span>    first: <span style="color:#a31515">&#34;Joe&#34;</span>,
</span></span><span style="display:flex;"><span>    last: <span style="color:#a31515">&#34;mama&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>console.log(obj.first) <span style="color:#008000">// =&gt; Joe
</span></span></span><span style="display:flex;"><span><span style="color:#008000"></span>obj.last = <span style="color:#a31515">&#34;Son&#34;</span>
</span></span><span style="display:flex;"><span>console.log(obj.last) <span style="color:#008000">// =&gt; Son
</span></span></span></code></pre></div>
</div>
<p>We can already get our properties, but we need to be able to set them.
Now in a pitiful language we would be stumped but not in ruby. Here setting
attributes is also a method that can be caught with <code>method_missing</code>!</p>
<div class="src src-ruby">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#00f">class</span> <span style="color:#2b91af">Hash</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">def</span> method_missing(prop, *args)
</span></span><span style="display:flex;"><span>    puts prop
</span></span><span style="display:flex;"><span>  <span style="color:#00f">end</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hash = {<span style="color:#a31515">hello</span>: <span style="color:#a31515">&#34;hi&#34;</span>}
</span></span><span style="display:flex;"><span>hash.hello = <span style="color:#a31515">&#34;greetings&#34;</span> <span style="color:#008000"># =&gt; :hello=</span></span></span></code></pre></div>
</div>
<p>as you can see, its just our method name with an equals sign appended too it.
check for that and we can set the property in question</p>
<div class="src src-ruby">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#00f">class</span> <span style="color:#2b91af">Hash</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">def</span> method_missing(prop, *args, &amp;block)
</span></span><span style="display:flex;"><span>   <span style="color:#00f">if</span> prop.end_with? <span style="color:#a31515">&#39;=&#39;</span>
</span></span><span style="display:flex;"><span>     self[prop.to_s.delete_suffix(<span style="color:#a31515">&#39;=&#39;</span>).to_sym] = args.first
</span></span><span style="display:flex;"><span>   <span style="color:#00f">else</span>
</span></span><span style="display:flex;"><span>     self[prop]
</span></span><span style="display:flex;"><span>   <span style="color:#00f">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">end</span>
</span></span><span style="display:flex;"><span><span style="color:#00f">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hash = {<span style="color:#a31515">hello</span>: <span style="color:#a31515">&#34;Hi&#34;</span>}
</span></span><span style="display:flex;"><span>puts hash.hello <span style="color:#008000"># =&gt; &#34;Hi&#34;</span>
</span></span><span style="display:flex;"><span>hash.hello = <span style="color:#a31515">&#34;greetings&#34;</span>
</span></span><span style="display:flex;"><span>puts hash.hello <span style="color:#008000"># =&gt; &#34;greetings&#34;</span></span></span></code></pre></div>
</div>
<p>
and just like that we can now get and set properties.</p>
</div>
</div>
<div id="outline-container-headline-48" class="outline-4">
<h4 id="headline-48">
Methods
</h4>
<div id="outline-text-headline-48" class="outline-text-4">
<p>Methods are a little more interesting, Methods are properties that are
functions. The way they access the object is through the use of the <code>this</code> keyword.</p>
<div class="src src-js">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>obj = {
</span></span><span style="display:flex;"><span>  first: <span style="color:#a31515">&#34;Joe&#34;</span>,
</span></span><span style="display:flex;"><span>  last: <span style="color:#a31515">&#34;Mama&#34;</span>,
</span></span><span style="display:flex;"><span>  full () {
</span></span><span style="display:flex;"><span>    <span style="color:#00f">return</span> <span style="color:#a31515">`</span><span style="color:#a31515">${</span><span style="color:#00f">this</span>.first<span style="color:#a31515">}</span><span style="color:#a31515"> </span><span style="color:#a31515">${</span><span style="color:#00f">this</span>.last<span style="color:#a31515">}</span><span style="color:#a31515">`</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>console.log(obj.full()) <span style="color:#008000">// =&gt; Joe Mama
</span></span></span></code></pre></div>
</div>
<p>
Now this is a trivial case but methods can do all sorts of things, not only
access our properties but set them with arguments taken in from the caller.
All of this hinges on accessing the special variableâ€¦</p>
<div id="outline-container-headline-49" class="outline-5">
<h5 id="headline-49">
<code>This</code>
</h5>
<div id="outline-text-headline-49" class="outline-text-5">
<p><code>this</code> in js is an implicit and usually hidden arguments to all functions (except
arrow functions). It contains a reference to the object we are working on, You
can think of it like <code>self</code> in languages such as python and ruby.</p>
<p>
<code>this</code> can be passed in explicitly by using the <code>.call</code> method on the function like
so. In fact the <code>obj.method()</code> is just syntax sugar for the <code>.call</code> method.</p>
<div class="src src-js">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>obj.full() == obj.full.call(obj) <span style="color:#008000">// =&gt; true
</span></span></span></code></pre></div>
</div>
<p>
This is visually similar to python. The only difference being that the
method definitions need to take in an implicit self argument as there first
positional argument.</p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#00f">class</span> <span style="color:#2b91af">Person</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#00f">def</span> method(self, *args): <span style="color:#008000"># explit self argument</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00f">return</span> args
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Person().method(1,2,3) <span style="color:#008000"># implict self passed in when called.</span></span></span></code></pre></div>
</div>
<p>
We can actually implement the python style of &#34;this passing&#34; relatively simply,
using lambdas and currying.</p>
<div class="src src-ruby">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#00f">class</span> <span style="color:#2b91af">Hash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">def</span> method_missing(prop, *args)
</span></span><span style="display:flex;"><span>    <span style="color:#00f">if</span> prop.end_with?(<span style="color:#a31515">&#34;=&#34;</span>) <span style="color:#008000"># check if its a set</span>
</span></span><span style="display:flex;"><span>      self[prop.to_s.delete_suffix(<span style="color:#a31515">&#39;=&#39;</span>).to_sym] = args.first
</span></span><span style="display:flex;"><span>    <span style="color:#00f">elsif</span> (accessed_prop = self[prop]).instance_of? Proc
</span></span><span style="display:flex;"><span>      <span style="color:#008000"># curry the method and then call it with self.</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000"># This returns another method which can take the rest of the arguments</span>
</span></span><span style="display:flex;"><span>      accessed_prop.curry.call(self)
</span></span><span style="display:flex;"><span>    <span style="color:#00f">else</span>
</span></span><span style="display:flex;"><span>      accessed_prop
</span></span><span style="display:flex;"><span>    <span style="color:#00f">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#00f">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00f">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hash = { <span style="color:#a31515">hello</span>: <span style="color:#a31515">&#39;Hi&#39;</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#a31515">greet</span>: -&gt;(this, name, l_name) { puts <span style="color:#a31515">&#34;</span><span style="color:#a31515">#{</span>this.hello<span style="color:#a31515">}</span><span style="color:#a31515">, </span><span style="color:#a31515">#{</span>name<span style="color:#a31515">}</span><span style="color:#a31515">, </span><span style="color:#a31515">#{</span>l_name<span style="color:#a31515">}</span><span style="color:#a31515">&#34;</span> } }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hash.hello = <span style="color:#a31515">&#39;greetings&#39;</span>
</span></span><span style="display:flex;"><span>puts hash.greet.(<span style="color:#a31515">&#39;Joe&#39;</span>, <span style="color:#a31515">&#39;Mama&#39;</span>) <span style="color:#008000"># =&gt; &#34;greetings, Joe Mama&#34;</span></span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-50" class="outline-5">
<h5 id="headline-50">
Getters and Setters
</h5>
</div>
</div>
</div>
<div id="outline-container-headline-51" class="outline-4">
<h4 id="headline-51">
Prototypes
</h4>
</div>
</div>
</div>
<div id="outline-container-headline-52" class="outline-3">
<h3 id="headline-52">
<span class="todo">DONE</span>
The Reader Applicative and abstraction&#xa0;&#xa0;&#xa0;<span class="tags"><span>haskell</span>&#xa0;<span>programming</span></span>
</h3>
<div id="outline-text-headline-52" class="outline-text-3">
<p>CLOSED: [2023-04-10 Mon 02:43]</p>
<p>
Now this is not a haskell blog site but this is the second interesting thing
haskell has offered me.</p>
<p>
Today we are discussing the curious nature of the Reader monad
(well the Reader applicative functor as I don&#39;t plan on delving into the
monad aspects a terrible amount)</p>
<p>
To do this we will be discussing this pairs function.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>pairs <span style="color:#00f">::</span> [a] <span style="color:#00f">-&gt;</span> [(a, a)]
</span></span><span style="display:flex;"><span>pairs <span style="color:#00f">=</span> zip &lt;*&gt; tail</span></span></code></pre></div>
</div>
<p>On the surface its all weird and magical, but we will walk through the types and
the implementations so that we can maybe pick up an intuition on how this works
in general.</p>
<p>
Now this function takes in a list and constructs a list of pairs, where the
second slot is the item over in the list from the first slot.
We can define it like this.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>pairs lst <span style="color:#00f">=</span> zip lst (tail lst)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print $ [1..5]
</span></span><span style="display:flex;"><span>print $ pairs [1..5]</span></span></code></pre></div>
</div>
<pre class="example">
[1,2,3,4,5]
[(1,2),(2,3),(3,4),(4,5)]
</pre>
<p>
Now the question becomes, how does the first become the second using the Reader
applicative? How does the type work out in such a neat fashion? How does this really
abstract thing turn into something so concrete and useful? Well fear not dear
<em>reader</em> we will answer these questions in due course.</p>
<div id="outline-container-headline-53" class="outline-4">
<h4 id="headline-53">
How do these types work out?
</h4>
<div id="outline-text-headline-53" class="outline-text-4">
<p>Lets start off with the types</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(&lt;*&gt;) <span style="color:#00f">::</span> <span style="color:#2b91af">Applicative</span> m <span style="color:#00f">=&gt;</span> m (a <span style="color:#00f">-&gt;</span> b) <span style="color:#00f">-&gt;</span> m a <span style="color:#00f">-&gt;</span> m b</span></span></code></pre></div>
</div>
<p>This is the general type of the <code>ap</code> operator but in this case we are working with
the Reader applicative. In that case we need to see what it looks like when we
collapse the constraint.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(&lt;*&gt;) <span style="color:#00f">::</span> (r <span style="color:#00f">-&gt;</span> (a <span style="color:#00f">-&gt;</span> b)) <span style="color:#008000">-- (1)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#00f">-&gt;</span> (r <span style="color:#00f">-&gt;</span> a)        <span style="color:#008000">-- (2)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#00f">-&gt;</span> (r <span style="color:#00f">-&gt;</span> b)        <span style="color:#008000">-- (3)</span></span></span></code></pre></div>
</div>
<p>
To anyone who has worked with haskell a little bit, this should be <em>readable</em>.</p>
<ol>
<li>is a function that takes in a value <code>r</code> and returns a function from <code>a</code> to <code>b</code></li>
<li>is a function from <code>r</code> to <code>a</code></li>
<li>is a function from <code>r</code> to <code>b</code>. This is our return value.</li>
</ol>
<p>where <code>r</code> <code>a</code> and <code>b</code> are type variables that will collapse as we apply arguments.
Note how our context is this <code>(r -&gt; ...)</code> function. This means ours functions have
to take in the same first argument. You can intuit this as an &#34;environment&#34;
these functions take in, though we will discuss the uses of the Reader monad in
a bit.</p>
<p>
We can actually clean this up a little bit, the <code>-&gt;</code> operator is right associative
meaning <code>a -&gt; b -&gt; c -&gt; d</code> is the same as <code>a -&gt; (b -&gt; (c -&gt; d))</code>.
With this knowledge in hand our type before turns into.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(&lt;*&gt;) <span style="color:#00f">::</span> (r <span style="color:#00f">-&gt;</span> a <span style="color:#00f">-&gt;</span> b)
</span></span><span style="display:flex;"><span>      <span style="color:#00f">-&gt;</span> (r <span style="color:#00f">-&gt;</span> a)
</span></span><span style="display:flex;"><span>      <span style="color:#00f">-&gt;</span> r
</span></span><span style="display:flex;"><span>      <span style="color:#00f">-&gt;</span> b</span></span></code></pre></div>
</div>
<p>
Here we can see something, our first argument is a function from <code>r</code> to <code>a</code> to <code>b</code>,
our, second argument is a function from <code>r</code> to <code>a</code>, This suggests we will combine
these functions so that the second argument to the first function is the result
of the second function (wordy I known). We also see how the return type <code>b</code> in the
first function is also the return type of the <code>ap</code> operator itself. This type is
pretty good at hinting both what this function takes in, and also how its
combining our arguments under the hood.</p>
<p>
Now lets have a look at the types of <code>zip</code> and <code>tail</code></p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>zip <span style="color:#00f">::</span> [a&#39;] <span style="color:#00f">-&gt;</span> [b&#39;] <span style="color:#00f">-&gt;</span> [(a&#39;, b&#39;)]
</span></span><span style="display:flex;"><span>tail <span style="color:#00f">::</span> [a&#39;] <span style="color:#00f">-&gt;</span> [a&#39;]</span></span></code></pre></div>
</div>
<p>
We can see both of these functions take in an <code>[a&#39;]</code> and then do something with
that. In other words our <code>[a&#39;]</code> becomes our <code>r</code>. We can continue this process of
subbing types into our <code>ap</code> operator.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>zip <span style="color:#00f">::</span> [a&#39;] <span style="color:#00f">-&gt;</span> [b&#39;] <span style="color:#00f">-&gt;</span> [(a&#39;, b&#39;)]
</span></span><span style="display:flex;"><span>  thus
</span></span><span style="display:flex;"><span>    r <span style="color:#00f">::</span> [a&#39;]
</span></span><span style="display:flex;"><span>    a <span style="color:#00f">::</span> [b&#39;]
</span></span><span style="display:flex;"><span>    b <span style="color:#00f">::</span> [(a&#39;, b&#39;)]</span></span></code></pre></div>
</div>
<p>
When we fill in our type with this information we can see our type popping out.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(zip &lt;*&gt;) <span style="color:#00f">::</span> ([a&#39;] <span style="color:#00f">-&gt;</span> [b&#39;]) <span style="color:#00f">-&gt;</span> [a&#39;] <span style="color:#00f">-&gt;</span> [(a&#39;, b&#39;)]</span></span></code></pre></div>
</div>
<p>
adding <code>tail</code> into the mix constrains the type of <code>b&#39;</code> even further</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>tail <span style="color:#00f">::</span> [a&#39;] <span style="color:#00f">-&gt;</span> [a&#39;]
</span></span><span style="display:flex;"><span>  thus
</span></span><span style="display:flex;"><span>     b&#39; <span style="color:#00f">::</span> a&#39;</span></span></code></pre></div>
</div>
<p>
applying this gives us our final type.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(zip &lt;*&gt; tail) <span style="color:#00f">::</span> [a&#39;] <span style="color:#00f">-&gt;</span> [(a&#39;, a&#39;)]</span></span></code></pre></div>
</div>
<p>
Congrats, we have now manually done the job of the haskell type checker.
Hopefully now we now see how just by following the types and using abstractions
we have come back to the <em>type</em> of thing we want to do. This is nice and all but
what about the actual implementation? the type is useless if it does not follow
our logic.</p>
</div>
</div>
<div id="outline-container-headline-54" class="outline-4">
<h4 id="headline-54">
Why does the implementation work out?
</h4>
<div id="outline-text-headline-54" class="outline-text-4">
<p>the implementation of our <code>ap</code> operator for our Reader Applicative is as follows</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(&lt;*&gt;) <span style="color:#00f">::</span> (r <span style="color:#00f">-&gt;</span> a <span style="color:#00f">-&gt;</span> b) <span style="color:#00f">-&gt;</span> (r <span style="color:#00f">-&gt;</span> a) <span style="color:#00f">-&gt;</span> r <span style="color:#00f">-&gt;</span> b
</span></span><span style="display:flex;"><span>(&lt;*&gt;) f g r <span style="color:#00f">=</span> f r (g r)</span></span></code></pre></div>
</div>
<p>
If we sub in our functions, we see our implementation pop out.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(&lt;*&gt;) zip tail lst <span style="color:#00f">::</span> [(a, a)]
</span></span><span style="display:flex;"><span>(&lt;*&gt;) zip tail lst <span style="color:#00f">=</span> zip lst (tail lst)</span></span></code></pre></div>
</div>
<p>
This leads us back to <code>pairs = zip &lt;*&gt; tail</code>, which becomes our final implementation.</p>
</div>
</div>
<div id="outline-container-headline-55" class="outline-4">
<h4 id="headline-55">
So now why does the reader monad exist?
</h4>
<div id="outline-text-headline-55" class="outline-text-4">
<p>Before we delve into that, we need discuss why we use applicatives and monads.
This was discussed in more detail in my <a href="/blog/posts/understanding-monads">understanding monads post</a>
but here is a smaller run down.</p>
<p>
An applicative functor allows us to compose contexts together into larger ones,
like we have seen. It allows for a lot of very interesting abstractions such as
parser combinators <sup class="footnote-reference"><a id="footnote-reference-1" href="#footnote-1">1</a></sup> as well as many other use cases (note that all monads
you have played with also are applicatives). We see here how we have taken two
functions that take in the same first argument and use the reader applicative to
combine them into something larger. This scales.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>zip3 <span style="color:#00f">::</span> [a] <span style="color:#00f">-&gt;</span> [b] <span style="color:#00f">-&gt;</span> [c] <span style="color:#00f">-&gt;</span> [(a, b, c)]
</span></span><span style="display:flex;"><span>(zip3 &lt;*&gt;) <span style="color:#00f">::</span> ([a] <span style="color:#00f">-&gt;</span> [b]) <span style="color:#00f">-&gt;</span> [a] <span style="color:#00f">-&gt;</span> [c] <span style="color:#00f">-&gt;</span> [(a, b, c)]
</span></span><span style="display:flex;"><span>(zip3 &lt;*&gt; map show) <span style="color:#00f">::</span> <span style="color:#2b91af">Show</span> a <span style="color:#00f">=&gt;</span> [a] <span style="color:#00f">-&gt;</span> [c] <span style="color:#00f">-&gt;</span> [(a, <span style="color:#2b91af">String</span>, c)]
</span></span><span style="display:flex;"><span>(zip3 &lt;*&gt; map show &lt;*&gt; map even) <span style="color:#00f">::</span> (<span style="color:#2b91af">Show</span> a, <span style="color:#2b91af">Integral</span> a) <span style="color:#00f">=&gt;</span> [a] <span style="color:#00f">-&gt;</span> [(a, <span style="color:#2b91af">String</span>, <span style="color:#2b91af">Bool</span>)]</span></span></code></pre></div>
</div>
<p>
Here we essentially collect transformations of a list of type <code>[a]</code> Each function
on the left hand side receives this <code>[a]</code> but its the responsibility of the left
most function to collect it all together. This is a small contrived example, yet
the rules here would apply to any set of functions that take in the
same first argument.</p>
<p>
Here we have a type with three parameters, we have functions that
extract out the information from a single string.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span><span style="color:#00f">data</span> <span style="color:#2b91af">Person</span> <span style="color:#00f">=</span> <span style="color:#2b91af">Person</span> {name <span style="color:#00f">::</span> <span style="color:#2b91af">String</span>, age <span style="color:#00f">::</span> <span style="color:#2b91af">Int</span>, job <span style="color:#00f">::</span> <span style="color:#2b91af">String</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>constructType <span style="color:#00f">::</span> <span style="color:#2b91af">String</span> <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">Person</span>
</span></span><span style="display:flex;"><span>constructType str <span style="color:#00f">=</span> <span style="color:#2b91af">Person</span>
</span></span><span style="display:flex;"><span>                        (extractName str)
</span></span><span style="display:flex;"><span>                        (extractAge str)
</span></span><span style="display:flex;"><span>                        (extractJob str)</span></span></code></pre></div>
</div>
<p>but now instead of passing in str manually we can use this Reader applicative to pass
this &#34;environment&#34; implicitly.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>constructType <span style="color:#00f">::</span> <span style="color:#2b91af">String</span> <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">Person</span>
</span></span><span style="display:flex;"><span>constructType <span style="color:#00f">=</span> <span style="color:#2b91af">Person</span> &lt;$&gt; extractName &lt;*&gt; extractAge &lt;*&gt; extractJob</span></span></code></pre></div>
</div>
<p>
Again here follow the types. <code>&lt;$&gt;</code> is fmap, it lifts <code>Person</code> from a simple function
to a function that works with our Reader applicative.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(<span style="color:#2b91af">Person</span> &lt;$&gt;) <span style="color:#00f">::</span> r <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">String</span> <span style="color:#00f">-&gt;</span> r <span style="color:#00f">-&gt;</span> (<span style="color:#2b91af">Int</span> <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">String</span> <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">Person</span>)</span></span></code></pre></div>
</div>
<p>
We can then keep on adding functions with the use of our <code>&lt;*&gt;</code> operator like so</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(<span style="color:#2b91af">Person</span> &lt;$&gt;) <span style="color:#00f">::</span> r <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">String</span> <span style="color:#00f">-&gt;</span> r <span style="color:#00f">-&gt;</span> (<span style="color:#2b91af">Int</span> <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">String</span> <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">Person</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#2b91af">Person</span> &lt;$&gt; extractName &lt;*&gt;) <span style="color:#00f">::</span> r <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">Int</span> <span style="color:#00f">-&gt;</span> (<span style="color:#2b91af">String</span> <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">Person</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#2b91af">Person</span> &lt;$&gt; extractName &lt;*&gt; extractAge) <span style="color:#00f">::</span> r <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">String</span> <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">Person</span>
</span></span><span style="display:flex;"><span>(<span style="color:#2b91af">Person</span> &lt;$&gt; extractName &lt;*&gt; extractAge &lt;*&gt; extractJob) <span style="color:#00f">::</span> r <span style="color:#00f">-&gt;</span> <span style="color:#2b91af">Person</span></span></span></code></pre></div>
</div>
<p>
We take this further with monads, where we can use the latter computation to
inform the next. It allows us to combine these computations together using
context.</p>
<p>
Its why the IO monad works so nicely. With the Reader monad it allows us to
compose together computations which all need some kind of shared read only state. Useful
when passing around things like app configurations (Values such as database
configuration or network settings that only become known at deploy time), or
something like react props</p>
<p>
This post only really focused on the Reader applicative, If you want to see how
the reader <em>monad</em> have a look at <a href="https://engineering.dollarshaveclub.com/the-reader-monad-example-motivation-542c54ccfaa8">this post from dollar shave club</a>.</p>
</div>
</div>
<div id="outline-container-headline-56" class="outline-4">
<h4 id="headline-56">
The neatness of abstraction.
</h4>
<div id="outline-text-headline-56" class="outline-text-4">
<p>We have now used abstract tools to solve our concrete problems, Why is this
neat? Well now that we have expressed our solution in terms of this abstraction,
we can use all of the tools and types of this abstraction to aid us further.</p>
<p>
take for example the function <code>sequenceA</code></p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>sequenceA <span style="color:#00f">::</span> (<span style="color:#2b91af">Traversable</span> t, <span style="color:#2b91af">Applicative</span> f) <span style="color:#00f">=&gt;</span> t (f a) <span style="color:#00f">-&gt;</span> f (t a)</span></span></code></pre></div>
</div>
<p>
here we can see it essentially can turn a type inside out, Now this may not seem
useful now but imagine what it would look like if we collapse the constraints.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>sequenceA <span style="color:#00f">::</span> [r <span style="color:#00f">-&gt;</span> a] <span style="color:#00f">-&gt;</span> r <span style="color:#00f">-&gt;</span> [a]</span></span></code></pre></div>
</div>
<p>
Here we have a function that takes in a list of functions from <code>r</code> to <code>a</code> and then
it returns a function from <code>r</code> to <code>[a]</code></p>
<p>
In other words, we can perform a set of transformations on a single value.</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>sequenceA [(+1), (+2), (+3)] 1</span></span></code></pre></div>
</div>
<table>
<tbody>
<tr>
<td class="align-right">2</td>
<td class="align-right">3</td>
<td class="align-right">4</td>
</tr>
</tbody>
</table>
<p>
This may seem contrived but you can imagine use cases. We need to pass a user
given value through a gauntlet of checks. or we take in a value and need multipe
permutations of it and so on. I am sure that people are more creative than me.</p>
<p>
Just by re-framing our problem using this abstraction, we have turned
something pretty manual and &#34;low level&#34; into something smaller, easier to extend
and nicer, and thats pretty neat.</p>
</div>
</div>
<div id="outline-container-headline-57" class="outline-4">
<h4 id="headline-57">
Conclusion
</h4>
<div id="outline-text-headline-57" class="outline-text-4">
<p>
Hopefully now you have a small intuition on the Reader Applicitive, The Reader
Monad is another beast but now you have the basics of the type out of the way
you can pick up that a with a little less head scratching.</p>
<p>
Again this was not written to be useful but if you did find it useful feel free
to email me, (its somewhere on this site).</p>
</div>
</div>
<div id="outline-container-headline-58" class="outline-4">
<h4 id="headline-58">
Appendix
</h4>
<div id="outline-text-headline-58" class="outline-text-4">
<p>So there is actually another version of the <code>ap</code> operator that is implemented in
terms of the Reader monad</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>pairs <span style="color:#00f">=</span> ap zip tail</span></span></code></pre></div>
</div>
<p>This is a historical artifact as Monads are older than Applicatives, but
it means we now have another way of framing the problem. As the type is
essentially the same (Just constrained to Monads) all of the type work we did
still <em>applies</em> but the implementation and how we get back to our first solution
is interesting.</p>
<p>
the implementation of ap is as follows</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>ap m1 m2 <span style="color:#00f">=</span> <span style="color:#00f">do</span> { x1 <span style="color:#00f">&lt;-</span> m1; x2 <span style="color:#00f">&lt;-</span> m2; return (x1 x2) }</span></span></code></pre></div>
</div>
<p>as do notation is syntax sugar for <code>&gt;&gt;=</code> lets get rid of it</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>ap m1 m2 <span style="color:#00f">=</span> m1 &gt;&gt;= (\x1 <span style="color:#00f">-&gt;</span> m2 &gt;&gt;= (\x2 <span style="color:#00f">-&gt;</span> return (x1 x2)))</span></span></code></pre></div>
</div>
<p>
The implementation of <code>&gt;&gt;=</code> and <code>return</code> are as follows</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span>(&gt;&gt;=)  <span style="color:#00f">::</span> (r <span style="color:#00f">-&gt;</span> a) <span style="color:#00f">-&gt;</span> (a <span style="color:#00f">-&gt;</span> r <span style="color:#00f">-&gt;</span> b) <span style="color:#00f">-&gt;</span> r <span style="color:#00f">-&gt;</span> b
</span></span><span style="display:flex;"><span>f &gt;&gt;= k <span style="color:#00f">=</span> \r <span style="color:#00f">-&gt;</span> k (f r) r
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>return <span style="color:#00f">::</span> a <span style="color:#00f">-&gt;</span> r <span style="color:#00f">-&gt;</span> a
</span></span><span style="display:flex;"><span>return <span style="color:#00f">=</span> const</span></span></code></pre></div>
</div>
<p>
With this we can start to sub</p>
<div class="src src-haskell">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span><span style="color:#008000">-- return = const</span>
</span></span><span style="display:flex;"><span>ap zip tail <span style="color:#00f">=</span> zip &gt;&gt;= (\x1 <span style="color:#00f">-&gt;</span> tail &gt;&gt;= (\x2 <span style="color:#00f">-&gt;</span> const (x1 x2)))
</span></span><span style="display:flex;"><span><span style="color:#008000">-- sub inner &gt;&gt;=</span>
</span></span><span style="display:flex;"><span>ap zip tail <span style="color:#00f">=</span> zip &gt;&gt;= (\x1 <span style="color:#00f">-&gt;</span> (\r2 <span style="color:#00f">-&gt;</span> (\x2 <span style="color:#00f">-&gt;</span> const (x1 x2)) (tail r2) r2)
</span></span><span style="display:flex;"><span><span style="color:#008000">-- sub outer &gt;&gt;=</span>
</span></span><span style="display:flex;"><span>ap zip tail <span style="color:#00f">=</span> (\r1 <span style="color:#00f">-&gt;</span> (\x1 <span style="color:#00f">-&gt;</span> (\r2 <span style="color:#00f">-&gt;</span> (\x2 <span style="color:#00f">-&gt;</span> const (x1 x2)) (tail r2) r2)) (zip r1) r1)
</span></span><span style="display:flex;"><span><span style="color:#008000">-- move r1 to the left hand side</span>
</span></span><span style="display:flex;"><span>ap zip tail r1 <span style="color:#00f">=</span> (\x1 <span style="color:#00f">-&gt;</span> (\r2 <span style="color:#00f">-&gt;</span> (\x2 <span style="color:#00f">-&gt;</span> const (x1 x2)) (tail r2) r2)) (zip r1) r1
</span></span><span style="display:flex;"><span><span style="color:#008000">-- replace x1 with (zip r1)</span>
</span></span><span style="display:flex;"><span>ap zip tail r1 <span style="color:#00f">=</span> (\r2 <span style="color:#00f">-&gt;</span> (\x2 <span style="color:#00f">-&gt;</span> const ((zip r1) x2)) (tail r2) r2) r1
</span></span><span style="display:flex;"><span><span style="color:#008000">-- replace x2 with (tail r2)</span>
</span></span><span style="display:flex;"><span>ap zip tail r1 <span style="color:#00f">=</span> (\r2 <span style="color:#00f">-&gt;</span> const ((zip r1) (tail r2)) r2) r1
</span></span><span style="display:flex;"><span><span style="color:#008000">-- replace r2 with r1</span>
</span></span><span style="display:flex;"><span>ap zip tail r1 <span style="color:#00f">=</span> const ((zip r1) (tail r1)) r1
</span></span><span style="display:flex;"><span><span style="color:#008000">-- const x = (\y -&gt; x)</span>
</span></span><span style="display:flex;"><span>ap zip tail r1 <span style="color:#00f">=</span> (\c1 <span style="color:#00f">-&gt;</span> ((zip r1) (tail r1))) r1
</span></span><span style="display:flex;"><span><span style="color:#008000">-- replace c1 with r1</span>
</span></span><span style="display:flex;"><span>ap zip tail r1 <span style="color:#00f">=</span> ((zip r1) (tail r1))
</span></span><span style="display:flex;"><span><span style="color:#008000">-- clean up</span>
</span></span><span style="display:flex;"><span>ap zip tail r <span style="color:#00f">=</span> (zip r) (tail r)</span></span></code></pre></div>
</div>
<p>
Easy to read, I know. This took me a while to work out but playing with it
helped quite a bit.</p>
</div>
</div>
<div id="outline-container-headline-59" class="outline-4">
<h4 id="headline-59">
Footnotes
</h4>
</div>
</div>
</div>
<div id="outline-container-headline-60" class="outline-3">
<h3 id="headline-60">
<span class="todo">TODO</span>
Ox Hugo is pretty nice&#xa0;&#xa0;&#xa0;<span class="tags"><span>blog</span>&#xa0;<span>hugo</span>&#xa0;<span>org</span>&#xa0;<span>emacs</span></span>
</h3>
<div id="outline-text-headline-60" class="outline-text-3">
<p>
I have been using <a href="https://ox-hugo.scripter.co/">ox-hugo</a> to write this blog for a little bit now, Not to spoil
the review ðŸ˜‰ but its been a pretty smooth experience. I wanted to discuss some
of the great aspects, some of the downsides and some of the tweaks to make it a
seamless experience.</p>
<div id="outline-container-headline-61" class="outline-4">
<h4 id="headline-61">
The good
</h4>
<div id="outline-text-headline-61" class="outline-text-4">
<p>Ox hugo has turned a mess of markdown files into a single neat org file (that
then tangles to that mess of markdown files). In short it has made blogging fun
again for me.</p>
<div id="outline-container-headline-62" class="outline-5">
<h5 id="headline-62">
Org
</h5>
<div id="outline-text-headline-62" class="outline-text-5">
<p>The reason I like org is not really the syntax, though i also do prefer the
syntax. Org has fantastic tooling an intergration with emacs that just makes it
a joy to write. From its ability to guess the next opening syntax of things like
headings, to the intuitive commands to manipulate those elements. This is not a
review of org mode but to say its not part of the reason I switched would</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-63" class="outline-4">
<h4 id="headline-63">
The eh
</h4>
</div>
<div id="outline-container-headline-64" class="outline-4">
<h4 id="headline-64">
The tweaks
</h4>
</div>
<div id="outline-container-headline-65" class="outline-4">
<h4 id="headline-65">
Conclusions
</h4>
</div>
<div id="outline-container-headline-66" class="outline-4">
<h4 id="headline-66">
Footnotes
</h4>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-67" class="outline-2">
<h2 id="headline-67">
COMMENT Local Variables&#xa0;&#xa0;&#xa0;<span class="tags"><span>ARCHIVE</span></span>
</h2>
</div>
<div class="footnotes">
<hr class="footnotes-separatator">
<div class="footnote-definitions">
<div class="footnote-definition">
<sup id="footnote-1"><a href="#footnote-reference-1">1</a></sup>
<div class="footnote-body">
<p>For those out of the loop, Parser combinators is a way to build up a
parser by composing smaller parsers together. <a href="https://www.youtube.com/watch?v=N9RUqGYuGfw">This video by the Tsoding really
helped me pick it up</a>. Its also the basis for libraries such as <a href="https://hackage.haskell.org/package/parsec">Parsec</a> and
other libraries that follow in its wake</p>
</div>
</div>
</div>
</div>

</article>
<nav class="no-print post-nav">


	<a class="next-post" href="https://www.jeetelongname.net/blog/posts/post1/">How to get started with Hugo and GitHub<img class="icon-text" src="/blog/img/next.svg"/>
	</a>

</nav>





			<hr class="sep" />
		</main>
		<footer class="container no-print">
			<div class="u-footer">
				

<a href="mailto:jeetelongname@gmail.com"><img class="icon-social" src="/blog/img/email.svg" alt="Email Me!"/></a>


<a href="https://github.com/jeetelongname"><img class="icon-social" src="/blog/img/github.svg" alt="Github"/></a>


<a href="https://www.jeetelongname.net/blog/index.xml" target="_blank"><img class="icon-social" src="/blog/img/feed.svg" alt="Feed"></a>


				<p>
					
					Theme used: <a href="https://github.com/yursan9/manis-hugo-theme">Manis</a><br>
					
					
					&copy 2022 Jeetaditya Chatterjee
					
					
				</p>
				
				<a href="#brand">
					<img class="icon-text" src="/blog/img/toup.svg" alt="To Up"/>
					<span>Back to Up</span>
				</a>
				
			</div>
		</footer>
		
		<script>hljs.initHighlightingOnLoad();</script>
		
	</body>
</html>

